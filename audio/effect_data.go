package audio

// TransientEffectId identifies a non-looping sound effect.
type TransientEffectId int

const (
	ExtraLife TransientEffectId = iota
	Credit
)

// BackgroundEffectId identifies a background (looping) sound effect.
type BackgroundEffectId int

const (
	Background1 BackgroundEffectId = iota
	Background2
	Background3
	Background4
	Background5
	EnergiserEaten
	EyesReturning
	UnusedEffect2
)

// PacmanEffectId identifies a transient sound made by pacman.
type PacmanEffectId int

const (
	DotEatenEven PacmanEffectId = iota
	DotEatenOdd
	FruitEaten
	GhostEaten
	PacmanDead
	PacmanPop
)

// effectData defines the attributes of a sound effect.
type effectData struct {
	octaveAndWave         byte // 0 : bits 6-4: frequency shift | bits 2-0: wave select
	initialBaseFreq       byte // 1 : initial base frequency
	freqIncr              byte // 2 : frequency increment (added to base freq)
	reverseAndDuration    byte // 3 : bits 7: reverse | bits 6-0: duration
	repeatFreqIncr        byte // 4 : frequency increment (added to initial base frequency). Used when repeat > 1
	repeatCounter         byte // 5 : repeat
	envelopeAndInitialVol byte // 6 : bits 7-4: volume adjust type | bits 3-0: initial volume
	volIncr               byte // 7 : volume increment
}

// effect2AlternateOffset is an index offset applied if alternate sound effects have been enabled.
const effect2AlternateOffset = 8

// effectTable collates the sound effect definitions for each channel.
var effectTable = [3][]effectData{
	{
		{0x73, 0x20, 0x00, 0x0c, 0x00, 0x0a, 0x1f, 0x00}, // 0 - extra life
		{0x72, 0x20, 0xfb, 0x87, 0x00, 0x02, 0x0f, 0x00}, // 1 - credit
	},
	{
		//pacman
		{0x36, 0x20, 0x04, 0x8c, 0x00, 0x00, 0x06, 0x00}, // 0 - end of energizer
		{0x36, 0x28, 0x05, 0x8b, 0x00, 0x00, 0x06, 0x00}, // 1 - higher freq when 155 dots eaten
		{0x36, 0x30, 0x06, 0x8a, 0x00, 0x00, 0x06, 0x00}, // 2 - higher freq when 179 dots eaten
		{0x36, 0x3c, 0x07, 0x89, 0x00, 0x00, 0x06, 0x00}, // 3 - higher freq when 12 dots left
		{0x36, 0x48, 0x08, 0x88, 0x00, 0x00, 0x06, 0x00}, // 4 - reset higher freq when 12 or less dots left
		{0x24, 0x00, 0x06, 0x08, 0x00, 0x00, 0x0a, 0x00}, // 5 - energizer eaten
		{0x40, 0x70, 0xfa, 0x10, 0x00, 0x00, 0x0a, 0x00}, // 6 - eyes returning
		{0x70, 0x04, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00}, // 7 - unused

		//alternate
		{0x59, 0x01, 0x06, 0x08, 0x00, 0x00, 0x02, 0x00}, // 0 - end of energizer
		{0x59, 0x01, 0x06, 0x09, 0x00, 0x00, 0x02, 0x00}, // 1 - higher freq when 155 dots eaten
		{0x59, 0x02, 0x06, 0x0a, 0x00, 0x00, 0x02, 0x00}, // 2 - higher freq when 179 dots eaten
		{0x59, 0x03, 0x06, 0x0b, 0x00, 0x00, 0x02, 0x00}, // 3 - higher freq when 12 dots left
		{0x59, 0x04, 0x06, 0x0c, 0x00, 0x06, 0x02, 0x00}, // 4 - reset higher freq when 12 or less dots left
		{0x24, 0x00, 0x06, 0x08, 0x02, 0x00, 0x0a, 0x00}, // 5 - energizer eaten
		{0x36, 0x07, 0x87, 0x6f, 0x00, 0x00, 0x04, 0x00}, // 6 - eyes returning
		{0x70, 0x04, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00}, // 7 - unused
	},
	{
		// pacman
		{0x42, 0x18, 0xfd, 0x06, 0x00, 0x01, 0x0c, 0x00}, // 0 - dot eating sound 1
		{0x42, 0x04, 0x03, 0x06, 0x00, 0x01, 0x0c, 0x00}, // 1 - dot eating sound 2
		{0x56, 0x0c, 0xff, 0x8c, 0x00, 0x02, 0x0f, 0x00}, // 2 - fruit eating sound
		{0x05, 0x00, 0x02, 0x20, 0x00, 0x01, 0x0c, 0x00}, // 3 - blue ghost eaten
		{0x41, 0x20, 0xff, 0x86, 0xfe, 0x1c, 0x0f, 0xff}, // 4 - pacman dying; ghosts bumping in act 2
		{0x70, 0x00, 0x01, 0x0c, 0x00, 0x01, 0x08, 0x00}, // 5 - pacman "pop"

		// alternate
		{0x1c, 0x70, 0x8b, 0x08, 0x00, 0x01, 0x06, 0x00}, // 0 - dot eating sound 1
		{0x1c, 0x70, 0x8b, 0x08, 0x00, 0x01, 0x06, 0x00}, // 1 - dot eating sound 2
		{0x56, 0x0c, 0xff, 0x8c, 0x00, 0x02, 0x08, 0x00}, // 2 - fruit eating sound
		{0x56, 0x00, 0x02, 0x0a, 0x07, 0x03, 0x0c, 0x00}, // 3 - blue ghost eaten
		{0x36, 0x38, 0xfe, 0x12, 0xf8, 0x04, 0x0f, 0xfc}, // 4 - pacman dying; ghosts bumping in act 2
		{0x22, 0x01, 0x01, 0x06, 0x00, 0x01, 0x07, 0x00}, // 5 - fruit bouncing
	},
}

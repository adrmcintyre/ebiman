package palette

import (
	"github.com/hajimehoshi/ebiten/v2/colorm"
)

const (
	BLACK        byte = 0  // blk blk blk blk
	BLINKY       byte = 1  // blk wht blu red
	PINKY        byte = 3  // blk wht blu pnk
	INKY         byte = 5  // blk wht blu cyn
	CLYDE        byte = 7  // blk wht blu org
	PACMAN       byte = 9  // blk blu red yel
	PACMAN2      byte = 9  // ^^
	GHOST_BONUS  byte = 9  // ^^ 200,400,800,1600
	GALAXIAN     byte = 9  // ^^
	PACMAN_GREEN byte = 10 // blk blu red grn
	PAL_14       byte = 14 // blk wht blk pil
	SCORE        byte = 15 // blk red grn wht
	STRAWBERRY   byte = 15 // ^^
	MAZE         byte = 16 // blk pil blk blu
	SCARED       byte = 17 // blk grn blu pil
	SCARED_FLASH byte = 18 // blk grn wht red
	APPLE        byte = 20 // blk red brn wht
	CHERRY       byte = 20 // ^^
	ORANGE       byte = 21 // blk org grn brn
	BELL         byte = 22 // blk yel stl wht
	KEY          byte = 22 // ^^
	PINEAPPLE    byte = 23 // blk stl grn wht
	GATE         byte = 24 // blk cyn pnk yel
	EYES         byte = 25 // blk wht blu blk
	PAL_26       byte = 26 // blk pil blk blu - maze special?
	TUNNEL       byte = 27 // blk pil blk blu
	PAL_29       byte = 29 // blk wht pil red
	PAL_30       byte = 30 // blk wht blu pil
	MAZE_FLASH   byte = 31 // blk pil blk wht
)

type Table [4]byte

// Format: color_index0, color_index1, color_index2, color_index3
var paletteData = [64]Table{
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x1}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x3}, //  0,  1,  2,  3
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x5}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x7}, //  4,  5,  6,  7
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xb, 0x1, 0x9}, {0x0, 0xb, 0x1, 0xc}, {0x0, 0x0, 0x0, 0x0}, //  8,  9, 10, 11
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0x0, 0xe}, {0x0, 0x1, 0xc, 0xf}, // 12, 13, 14, 15
	{0x0, 0xe, 0x0, 0xb}, {0x0, 0xc, 0xb, 0xe}, {0x0, 0xc, 0xf, 0x1}, {0x0, 0x0, 0x0, 0x0}, // 16, 17, 18, 19
	{0x0, 0x1, 0x2, 0xf}, {0x0, 0x7, 0xc, 0x2}, {0x0, 0x9, 0x6, 0xf}, {0x0, 0xd, 0xc, 0xf}, // 20, 21, 22, 23
	{0x0, 0x5, 0x3, 0x9}, {0x0, 0xf, 0xb, 0x0}, {0x0, 0xe, 0x0, 0xb}, {0x0, 0xe, 0x0, 0xb}, // 24, 25, 26, 27
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xe, 0x1}, {0x0, 0xf, 0xb, 0xe}, {0x0, 0xe, 0x0, 0xf}, // 28, 29, 30, 31

	// entries 32-63 not used
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
}

var ColorM [64]colorm.ColorM

func MakeColorMatrixes() {
	var r, g, b float64
	for i := range 64 {
		mat := colorm.ColorM{}
		for j := range 3 {
			ci := paletteData[i][1+j]
			colorData[ci].ToRGB(&r, &g, &b)
			mat.SetElement(0, j, r)
			mat.SetElement(1, j, g)
			mat.SetElement(2, j, b)
		}
		ColorM[i] = mat
	}
}

package color

import (
	"github.com/hajimehoshi/ebiten/v2/colorm"
)

type paletteEntry [4]byte

// Format: color_index0, color_index1, color_index2, color_index3
var paletteData = [64]paletteEntry{
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x1}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x3}, //  0,  1,  2,  3
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x5}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xb, 0x7}, //  4,  5,  6,  7
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xb, 0x1, 0x9}, {0x0, 0xb, 0x1, 0xc}, {0x0, 0x0, 0x0, 0x0}, //  8,  9, 10, 11
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0x0, 0xe}, {0x0, 0x1, 0xc, 0xf}, // 12, 13, 14, 15
	{0x0, 0xe, 0x0, 0xb}, {0x0, 0xc, 0xb, 0xe}, {0x0, 0xc, 0xf, 0x1}, {0x0, 0x0, 0x0, 0x0}, // 16, 17, 18, 19
	{0x0, 0x1, 0x2, 0xf}, {0x0, 0x7, 0xc, 0x2}, {0x0, 0x9, 0x6, 0xf}, {0x0, 0xd, 0xc, 0xf}, // 20, 21, 22, 23
	{0x0, 0x5, 0x3, 0x9}, {0x0, 0xf, 0xb, 0x0}, {0x0, 0xe, 0x0, 0xb}, {0x0, 0xe, 0x0, 0xb}, // 24, 25, 26, 27
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0xf, 0xe, 0x1}, {0x0, 0xf, 0xb, 0xe}, {0x0, 0xe, 0x0, 0xf}, // 28, 29, 30, 31

	// entries 32-63 not used
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
	{0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0},
}

var ColorM [64]colorm.ColorM

func MakeColorMatrixes() {
	var r, g, b float64
	for i := range 64 {
		mat := colorm.ColorM{}
		for j := range 3 {
			ci := paletteData[i][1+j]
			colorData[ci].toRGB(&r, &g, &b)
			mat.SetElement(0, j, r)
			mat.SetElement(1, j, g)
			mat.SetElement(2, j, b)
		}
		ColorM[i] = mat
	}
}
